version: '2'

rules:

- rule: greet
  conversation_start: true
  steps:
  - intent: greet
  - action: utter_greet
  - action: utter_help
  
- rule: Greet the user upon handoff
  steps:
  - intent: handoff
  - action: utter_greet

- rule: say goodbye
  steps:
  - intent: goodbye
  - action: utter_goodbye
  
- rule: help
  steps:
  - intent: help
  - action: utter_help
  
- rule: thankyou
  steps:
  - intent: thankyou
  - action: utter_noworries
  
- rule: is there a transfer charge
  steps:
  - intent: ask_transfer_charge
  - action: utter_transfer_charge
  
- rule: Show list of known recipients
  steps:
  - intent: check_recipients
  - action: action_recipients
  
- rule: Show bank account balance when account_type is not set
  condition:
  - slot_was_set:
    - account_type: null
  steps:
  - intent: check_balance
  - action: action_account_balance
  - slot_was_set:
    - account_type: null
  
- rule: Show bank account balance when account_type is 'bank'
  condition:
  - slot_was_set:
    - account_type: bank
  steps:
  - intent: check_balance
  - action: action_account_balance
  - slot_was_set:
    - account_type: null
    
- rule: Show balance of all credit cards when account_type is 'credit'
  condition:
  - slot_was_set:
    - account_type: credit
  steps:
  - intent: check_balance
  - action: action_credit_card_balance
  - slot_was_set:
    - account_type: null
  
- rule: Show balance of a specific credit card when account_type is not set
  condition:
  - slot_was_set:
    - account_type: null
  - slot_was_set:
    - credit_card: some value
  steps:
  - intent: check_balance
  - action: action_credit_card_balance
  - slot_was_set:
    - account_type: null
    
- rule: Activate cc_payment_form
  steps:
  - intent: pay_cc
  - action: cc_payment_form
  - active_loop: cc_payment_form
  
- rule: Submit cc_payment_form
  condition:
  - active_loop: cc_payment_form
  steps:
  - action: cc_payment_form
  - active_loop: null
  - slot_was_set:
    - credit_card: some value
  - slot_was_set:
    - requested_slot: null
  - action: action_pay_cc
  - slot_was_set:
    - credit_card: null
  - slot_was_set:
    - account_type: null
  
- rule: Activate transfer_money_form
  steps:
  - intent: transfer_money
  - action: transfer_money_form
  - active_loop: transfer_money_form
  
- rule: Submit transfer_money_form after all slots are filled
  condition:
  - active_loop: transfer_money_form
  steps:
  - action: transfer_money_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: action_transfer_money

- rule: Activate transaction_search_form from search_transactions intent
  steps:
  - intent: search_transactions
  - action: transaction_search_form
  - active_loop: transaction_search_form

- rule: Activate transaction_search_form from check_earnings intent
  steps:
  - intent: check_earnings
  - action: transaction_search_form
  - active_loop: transaction_search_form
  
- rule: Submit transaction_search_form
  condition:
  - active_loop: transaction_search_form
  steps:
  - action: transaction_search_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: action_transaction_search
